language: c
cache:
  directories:
    - $HOME/.opam
before_cache:
  - rm -rf $HOME/.opam/log
script:
  - opam init -y
  - eval `opam config env`
  - opam pin add core_kernel 112.17.00 -y
  - opam pin add bap --dev-repo -y
  - opam install -y oasis
  - oasis setup
  - make
  - make test
sudo: false
addons:
  apt:
    sources:
    - avsm
    packages:
    - camlp4
    - camlp4-extra
    - clang
    - curl
    - libcurl4-gnutls-dev
    - libgmp-dev
    - libssl-dev
    - libzip-dev
    - llvm
    - llvm-3.4-dev
    - m4
    - ocaml
    - ocaml-base
    - ocaml-base-nox
    - ocaml-compiler-libs
    - ocaml-native-compilers
    - ocaml-nox
    - time
    - opam
    - aspcud
